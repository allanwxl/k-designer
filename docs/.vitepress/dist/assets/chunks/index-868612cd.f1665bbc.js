import{e as K,am as q,r as I,a2 as ue,H as fe,f as g,w as H,N as de,k as me,o as N,v as P,d as o,q as p,b as u,n as r,u as a,s as j,A as ve,F as O,c as E,M as J,Q as pe,X as be,D as ke,E as ge,g as we,y as ye,ag as he}from"../app.f47f61a8.js";import{bC as xe,i as Ce,e as ze,aW as Ie,$ as Q,l as Ne,t as w,O as Oe,ah as _e,s as Te,bJ as Ae,aY as Le,bK as Re,bL as Be,U as Ee,bM as Xe,bN as Ye,ad as A,p as $e,a7 as z,bF as De}from"./index-b8b964c9.8f77b590.js";import{A as Fe,E as Me}from"./index-cceb3c2d.d2d707d4.js";import{z as Se}from"./debounce-fcbdcf8b.94e37249.js";var Ve="Expected a function";function X(h,_,b){var t=!0,f=!0;if(typeof h!="function")throw new TypeError(Ve);return xe(b)&&(t="leading"in b?!!b.leading:t,f="trailing"in b?!!b.trailing:f),Se(h,_,{leading:t,maxWait:_,trailing:f})}const We=Ce({urlList:{type:ze(Array),default:()=>Ie([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),qe={close:()=>!0,switch:h=>Q(h)},He=["src"],Pe=K({name:"ElImageViewer"}),je=K({...Pe,props:We,emits:qe,setup(h,{expose:_,emit:b}){const t=h,f={CONTAIN:{name:"contain",icon:q(Xe)},ORIGINAL:{name:"original",icon:q(Ye)}},{t:U}=Fe(),l=Ne("image-viewer"),{nextZIndex:G}=Me(),L=I(),Y=I([]),$=ue(),x=I(!0),k=I(t.initialIndex),T=fe(f.CONTAIN),i=I({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),Z=g(()=>{const{urlList:e}=t;return e.length<=1}),D=g(()=>k.value===0),F=g(()=>k.value===t.urlList.length-1),ee=g(()=>t.urlList[k.value]),ae=g(()=>[l.e("btn"),l.e("prev"),l.is("disabled",!t.infinite&&D.value)]),ne=g(()=>[l.e("btn"),l.e("next"),l.is("disabled",!t.infinite&&F.value)]),se=g(()=>{const{scale:e,deg:n,offsetX:s,offsetY:c,enableTransition:d}=i.value;let m=s/e,v=c/e;switch(n%360){case 90:case-270:[m,v]=[v,-m];break;case 180:case-180:[m,v]=[-m,-v];break;case 270:case-90:[m,v]=[-v,m];break}const C={transform:`scale(${e}) rotate(${n}deg) translate(${m}px, ${v}px)`,transition:d?"transform .3s":""};return T.value.name===f.CONTAIN.name&&(C.maxWidth=C.maxHeight="100%"),C}),te=g(()=>Q(t.zIndex)?t.zIndex:G());function R(){oe(),b("close")}function le(){const e=X(s=>{switch(s.code){case z.esc:t.closeOnPressEscape&&R();break;case z.space:S();break;case z.left:V();break;case z.up:y("zoomIn");break;case z.right:W();break;case z.down:y("zoomOut");break}}),n=X(s=>{const c=s.deltaY||s.deltaX;y(c<0?"zoomIn":"zoomOut",{zoomRate:t.zoomRate,enableTransition:!1})});$.run(()=>{A(document,"keydown",e),A(document,"wheel",n)})}function oe(){$.stop()}function ie(){x.value=!1}function ce(e){x.value=!1,e.target.alt=U("el.image.error")}function re(e){if(x.value||e.button!==0||!L.value)return;i.value.enableTransition=!1;const{offsetX:n,offsetY:s}=i.value,c=e.pageX,d=e.pageY,m=X(C=>{i.value={...i.value,offsetX:n+C.pageX-c,offsetY:s+C.pageY-d}}),v=A(document,"mousemove",m);A(document,"mouseup",()=>{v()}),e.preventDefault()}function M(){i.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function S(){if(x.value)return;const e=De(f),n=Object.values(f),s=T.value.name,c=(n.findIndex(d=>d.name===s)+1)%e.length;T.value=f[e[c]],M()}function B(e){const n=t.urlList.length;k.value=(e+n)%n}function V(){D.value&&!t.infinite||B(k.value-1)}function W(){F.value&&!t.infinite||B(k.value+1)}function y(e,n={}){if(x.value)return;const{zoomRate:s,rotateDeg:c,enableTransition:d}={zoomRate:t.zoomRate,rotateDeg:90,enableTransition:!0,...n};switch(e){case"zoomOut":i.value.scale>.2&&(i.value.scale=Number.parseFloat((i.value.scale/s).toFixed(3)));break;case"zoomIn":i.value.scale<7&&(i.value.scale=Number.parseFloat((i.value.scale*s).toFixed(3)));break;case"clockwise":i.value.deg+=c;break;case"anticlockwise":i.value.deg-=c;break}i.value.enableTransition=d}return H(ee,()=>{de(()=>{const e=Y.value[0];e!=null&&e.complete||(x.value=!0)})}),H(k,e=>{M(),b("switch",e)}),me(()=>{var e,n;le(),(n=(e=L.value)==null?void 0:e.focus)==null||n.call(e)}),_({setActiveItem:B}),(e,n)=>(N(),P(he,{to:"body",disabled:!e.teleported},[o(ye,{name:"viewer-fade",appear:""},{default:p(()=>[u("div",{ref_key:"wrapper",ref:L,tabindex:-1,class:r(a(l).e("wrapper")),style:j({zIndex:a(te)})},[u("div",{class:r(a(l).e("mask")),onClick:n[0]||(n[0]=ve(s=>e.hideOnClickModal&&R(),["self"]))},null,2),O(" CLOSE "),u("span",{class:r([a(l).e("btn"),a(l).e("close")]),onClick:R},[o(a(w),null,{default:p(()=>[o(a(Oe))]),_:1})],2),O(" ARROW "),a(Z)?O("v-if",!0):(N(),E(J,{key:0},[u("span",{class:r(a(ae)),onClick:V},[o(a(w),null,{default:p(()=>[o(a(_e))]),_:1})],2),u("span",{class:r(a(ne)),onClick:W},[o(a(w),null,{default:p(()=>[o(a(Te))]),_:1})],2)],64)),O(" ACTIONS "),u("div",{class:r([a(l).e("btn"),a(l).e("actions")])},[u("div",{class:r(a(l).e("actions__inner"))},[o(a(w),{onClick:n[1]||(n[1]=s=>y("zoomOut"))},{default:p(()=>[o(a(Ae))]),_:1}),o(a(w),{onClick:n[2]||(n[2]=s=>y("zoomIn"))},{default:p(()=>[o(a(Le))]),_:1}),u("i",{class:r(a(l).e("actions__divider"))},null,2),o(a(w),{onClick:S},{default:p(()=>[(N(),P(pe(a(T).icon)))]),_:1}),u("i",{class:r(a(l).e("actions__divider"))},null,2),o(a(w),{onClick:n[3]||(n[3]=s=>y("anticlockwise"))},{default:p(()=>[o(a(Re))]),_:1}),o(a(w),{onClick:n[4]||(n[4]=s=>y("clockwise"))},{default:p(()=>[o(a(Be))]),_:1})],2)],2),O(" CANVAS "),u("div",{class:r(a(l).e("canvas"))},[(N(!0),E(J,null,be(e.urlList,(s,c)=>ke((N(),E("img",{ref_for:!0,ref:d=>Y.value[c]=d,key:s,src:s,style:j(a(se)),class:r(a(l).e("img")),onLoad:ie,onError:ce,onMousedown:re},null,46,He)),[[ge,c===k.value]])),128))],2),we(e.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var Je=$e(je,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const Ze=Ee(Je);export{qe as B,We as D,Ze as q};
